SELECT db.meter_number AS meter, CASE WHEN db.time_stamp < db.bill_date + INTERVAL '8 hour' THEN 1 ELSE 0 END AS "Sla received within 8 HRS", CASE WHEN db.time_stamp >= db.bill_date + INTERVAL '8 hour' AND db.time_stamp < db.bill_date + INTERVAL '12 hour' THEN 1 ELSE 0 END AS "Sla received within 12 HRS", CASE WHEN db.time_stamp >= db.bill_date + INTERVAL '12 hour' AND db.time_stamp < db.bill_date + INTERVAL '24 hour' THEN 1 ELSE 0 END AS "Sla received within 24 HRS", CASE WHEN db.time_stamp >= db.bill_date + INTERVAL '24 hour' AND db.time_stamp < db.bill_date + INTERVAL '72 hour' THEN 1 ELSE 0 END AS "Sla received within 72 HRS", CASE WHEN db.time_stamp >= db.bill_date + INTERVAL '72 hour' AND db.time_stamp < db.bill_date + INTERVAL '168 hour' THEN 1 ELSE 0 END AS "Sla received within 168 HRS" FROM hes.data_bill db WHERE db.bill_date = '2025-07-01 00:00:00' AND db.meter_number IN ( SELECT meter_number FROM hes.meter_master WHERE time_stamp < '2025-07-01 00:00:00' );
